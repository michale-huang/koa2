(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b65f25f6"],{"53be":function(e,t,s){},5669:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"add-product"},[s("div",{staticClass:"choose-type"},[e._v(" 选择服务产品类型： "),s("Select",{on:{"on-change":e.goToAddProduct},model:{value:e.productType,callback:function(t){e.productType=t},expression:"productType"}},e._l(e.serviceType,(function(t){return s("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(" "+e._s(t.dictionaryValue)+" ")])})),1)],1),s("div",{staticClass:"white-bg add-product-content"},[s("div",{staticClass:"add-site"},[s("Row",[s("Col",{attrs:{span:"3"}},[s("div",{staticClass:"name"},[e._v("添加场所:")])]),s("Col",{attrs:{span:"21"}},[s("Form",{ref:"formValidate",attrs:{"label-position":"left",model:e.siteData,rules:e.ruleValidate,"label-colon":!0,"label-width":85,inline:""}},[s("FormItem",{attrs:{label:"国家城市",prop:"dispatchCity"}},[s("adt-city-selector",{on:{"on-change":e.changeDispatchCity}})],1),s("FormItem",{attrs:{label:"选择场所",prop:"dispatchSite"}},[s("Select",{attrs:{clearable:""},model:{value:e.siteData.dispatchSite,callback:function(t){e.$set(e.siteData,"dispatchSite",t)},expression:"siteData.dispatchSite"}},e._l(e.dispatchOptions,(function(t,a){return s("Option",{key:a,attrs:{value:t.value+"~"+t.label}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1)],1)],1)],1),s("div",{staticClass:"choose-parameter"},[s("h6",{staticStyle:{"margin-top":"0"}},[e._v("选择参数：")]),s("div",{staticClass:"container"},[s("Form",{ref:"parameterFormValidate",attrs:{"label-position":"left",model:e.parameterData,rules:e.parameterRuleValidate,"label-colon":!0,"label-width":126,inline:""}},[s("FormItem",{attrs:{label:"运输类型",prop:"trspType"}},[s("Select",{attrs:{clearable:""},model:{value:e.parameterData.trspType,callback:function(t){e.$set(e.parameterData,"trspType",t)},expression:"parameterData.trspType"}},e._l(e.trspType,(function(t){return s("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey+"~"+t.dictionaryValue}},[e._v(" "+e._s(t.dictionaryValue)+" ")])})),1)],1),s("FormItem",{attrs:{label:"物流类型",prop:"logisticsType"}},[s("Select",{attrs:{clearable:""},model:{value:e.parameterData.logisticsType,callback:function(t){e.$set(e.parameterData,"logisticsType",t)},expression:"parameterData.logisticsType"}},e._l(e.logisticsType,(function(t){return s("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey+"~"+t.dictionaryValue}},[e._v(" "+e._s(t.dictionaryValue)+" ")])})),1)],1)],1),s("div",{staticClass:"btns"},[s("Button",{on:{click:function(t){return e.handleReset()}}},[e._v("重置参数")]),s("Button",{attrs:{type:"primary"},on:{click:function(t){return e.saveParameter()}}},[e._v("保存参数")])],1)],1)]),s("div",{staticClass:"public-component-line"}),s("div",{staticClass:"product-list public-modify-record"},[s("div",{staticClass:"collapse"},[s("Collapse",{attrs:{accordion:""},model:{value:e.curCollapse,callback:function(t){e.curCollapse=t},expression:"curCollapse"}},[e._l(e.productAllInfo,(function(t,a){return[s("Panel",{attrs:{name:a+""},on:{click:function(t){e.curCollapse=a}}},[s("Row",[t.serverCode?s("Col",{staticClass:"product-number",attrs:{span:"6"}},[e._v(" 产品编号："+e._s(t.serverCode)+" ")]):e._e(),s("Col",{staticClass:"parameter",attrs:{span:"13"}},[e._v(" 产品参数："+e._s(t.parameters)+" ")]),0===a&&e.hasPendingProduct?s("Col",{staticClass:"btns",attrs:{span:"4"}},[s("Button",{attrs:{size:"small"},on:{click:function(s){return s.stopPropagation(),e.saveProduct(t)}}},[e._v("保存产品")])],1):e._e()],1),s("div",{attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"product-content"},[s("div",{class:["scene-btns",{spread:e.isSceneSpread}]},[s("adt-tab-btns",{staticClass:"scene-tab",attrs:{titleNames:t.sceneNames,isSmallBtn:!0,btnIndex:t.sceneTabIndex||-1,productIndex:a},on:{handleBtn:e.handleSceneBtn}}),s("div",{staticClass:"right-item"},[s("Button",{attrs:{size:"small",disabled:!(0===a&&e.hasPendingProduct)},on:{click:function(t){return e.chooseScene(a)}}},[e._v(" 选择场景 ")]),s("div",{staticClass:"show-all-scene",on:{click:function(t){e.isSceneSpread=!e.isSceneSpread}}},[e._v(" "+e._s((e.isSceneSpread?"收起":"展开")+"所有 >")+" ")])],1)],1),e._l(t.sceneNames,(function(i,n){return s("div",{directives:[{name:"show",rawName:"v-show",value:i===e.curSceneName,expression:"item === curSceneName"}],key:n},[s("adt-tab-btns",{staticClass:"task-tab",attrs:{titleNames:e.titleNames,isUnderline:!0,btnIndex:e.tabIndex,width:250,height:40},on:{handleBtn:e.handleBtn}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isBasicTask,expression:"isBasicTask"}],staticClass:"basic-item"},[s("Row",{staticClass:"item-container"},[s("Col",{staticClass:"item",attrs:{span:"10"}},[e._v(" 基础服务总费用： "),s("Input",{attrs:{disabled:!(0===a&&e.hasPendingProduct)},model:{value:t.scenesList[n].taskBasesList.taskCost,callback:function(s){e.$set(t.scenesList[n].taskBasesList,"taskCost",e._n("string"===typeof s?s.trim():s))},expression:"product.scenesList[idx].taskBasesList.taskCost"}}),s("Select",{staticStyle:{width:"80px"},attrs:{disabled:!(0===a&&e.hasPendingProduct),clearable:""},model:{value:t.scenesList[n].taskBasesList.curr,callback:function(s){e.$set(t.scenesList[n].taskBasesList,"curr",s)},expression:"product.scenesList[idx].taskBasesList.curr"}},e._l(e.currencyCode,(function(t){return s("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(" "+e._s(t.dictionaryValue)+" ")])})),1),e._v(" /"+e._s("C"===t.trspType?"TEU":"KG")+" ")],1),s("Col",{staticClass:"item",attrs:{span:"14"}},[e._v(" 基础服务总时长： "),s("Input",{attrs:{disabled:!(0===a&&e.hasPendingProduct)},model:{value:t.scenesList[n].taskBasesList.serverDuration,callback:function(s){e.$set(t.scenesList[n].taskBasesList,"serverDuration",e._n("string"===typeof s?s.trim():s))},expression:"product.scenesList[idx].taskBasesList.serverDuration"}}),s("Select",{staticStyle:{width:"80px"},attrs:{disabled:!(0===a&&e.hasPendingProduct),clearable:""},model:{value:t.scenesList[n].taskBasesList.serverDurationUnit,callback:function(s){e.$set(t.scenesList[n].taskBasesList,"serverDurationUnit",s)},expression:"product.scenesList[idx].taskBasesList.serverDurationUnit"}},e._l(e.timeUnit,(function(t){return s("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(" "+e._s(t.dictionaryValue)+" ")])})),1)],1)],1),s("adt-task-content",{attrs:{basicTask:t.scenesList[n].taskBasesList.lists,isAdditionalTasks:!1,showPriceAndTime:!1}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isBasicTask,expression:"!isBasicTask"}],staticClass:"additional-item"},[s("h6",[e._v("选择附加任务:")]),s("div",{staticClass:"task-container"},e._l(t.scenesList[n].taskAffixesList,(function(i,n){return s("div",{key:n,staticClass:"task-item"},[s("Checkbox",{attrs:{disabled:!(0===a&&e.hasPendingProduct)},model:{value:i.isChecked,callback:function(t){e.$set(i,"isChecked",t)},expression:"additionalTask.isChecked"}}),s("div",{staticClass:"task-name"},[e._v(e._s(i.taskName))]),s("div",{staticClass:"cost"},[e._v(" 费用： "),s("Input",{attrs:{disabled:!(0===a&&e.hasPendingProduct)},model:{value:i.taskCost,callback:function(t){e.$set(i,"taskCost",e._n("string"===typeof t?t.trim():t))},expression:"additionalTask.taskCost"}}),s("Select",{staticStyle:{width:"80px","margin-left":"12px"},attrs:{disabled:!(0===a&&e.hasPendingProduct),clearable:""},model:{value:i.curr,callback:function(t){e.$set(i,"curr",t)},expression:"additionalTask.curr"}},e._l(e.currencyCode,(function(t){return s("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(" "+e._s(t.dictionaryValue)+" ")])})),1),e._v(" /"+e._s("C"===t.trspType?"TEU":"KG")+" ")],1),s("div",{staticClass:"time"},[e._v(" 时长： "),s("Input",{attrs:{disabled:!(0===a&&e.hasPendingProduct)},model:{value:i.serverDuration,callback:function(t){e.$set(i,"serverDuration",e._n("string"===typeof t?t.trim():t))},expression:"additionalTask.serverDuration"}}),s("Select",{staticStyle:{width:"80px","margin-left":"12px"},attrs:{disabled:!(0===a&&e.hasPendingProduct),clearable:""},model:{value:i.serverDurationUnit,callback:function(t){e.$set(i,"serverDurationUnit",t)},expression:"additionalTask.serverDurationUnit"}},e._l(e.timeUnit,(function(t){return s("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(" "+e._s(t.dictionaryValue)+" ")])})),1)],1)],1)})),0)])],1)})),s("div",{staticClass:"public-component-line thin-line"}),s("Row",{staticClass:"set-dead-line"},[s("Col",{attrs:{span:"10"}},[e._v(" 产品起止日期： "),s("DatePicker",{attrs:{type:"date",disabled:!(0===a&&e.hasPendingProduct)},model:{value:t.serverStartTime,callback:function(s){e.$set(t,"serverStartTime",s)},expression:"product.serverStartTime"}}),e._v(" -- "),s("DatePicker",{attrs:{type:"date",disabled:!(0===a&&e.hasPendingProduct)},model:{value:t.serverEndTime,callback:function(s){e.$set(t,"serverEndTime",s)},expression:"product.serverEndTime"}})],1),s("Col",{attrs:{span:"14"}},[e._v(" 产品报价截止时间前 "),s("Input",{attrs:{disabled:!(0===a&&e.hasPendingProduct)},model:{value:t.serverRemindDuration,callback:function(s){e.$set(t,"serverRemindDuration",e._n(s))},expression:"product.serverRemindDuration"}}),e._v(" 天开始提醒 ")],1)],1)],2)])],1)]}))],2)],1)])]),s("adt-my-modal",{attrs:{title:"选择场景",width:"60%",showModal:e.isSceneModalShow},on:{"on-visible-change":e.sceneVisibleChange,"on-ok":function(t){return e.confirmChooseScene()}}},[s("div",{staticClass:"choose-scene-container"},[s("div",{staticClass:"scene-container"},[s("div",{staticClass:"search-container"},[s("div",{staticClass:"search"},[e._v(" 场景名称： "),s("Input",{model:{value:e.sceneName,callback:function(t){e.sceneName=t},expression:"sceneName"}}),s("Icon",{staticClass:"search-btn",attrs:{type:"ios-search"},on:{click:e.searchScene}})],1),s("Button",{attrs:{type:"primary"},on:{click:function(t){return e.previewSort()}}},[e._v("排序预览")])],1),s("Table",{attrs:{"max-height":"500",columns:e.sceneColumns,data:e.sceneTableData,stripe:""},on:{"on-selection-change":e.selectionChange},scopedSlots:e._u([{key:"sort",fn:function(t){var a=t.row,i=t.index;return[s("div",{staticStyle:{position:"relative"}},[s("span",{staticClass:"required-tag"},[e._v("*")]),s("Input",{attrs:{clearable:""},on:{"on-change":function(t){return e.changeRowData(a,i,"sort")}},model:{value:a.sort,callback:function(t){e.$set(a,"sort","string"===typeof t?t.trim():t)},expression:"row.sort"}})],1)]}}])})],1),s("div",{staticClass:"sort-container"},[s("div",{staticClass:"title"},[e._v("场景排序")]),s("Table",{attrs:{columns:e.previewColumns,data:e.previewTableData,"max-height":"500",stripe:""}})],1)])])],1)},i=[],n=(s("99af"),s("a15b"),s("a434"),s("96cf"),s("1da1")),r=s("b85c"),c=s("9c46"),o=s("3fec"),l=s("b962"),d=s("35ec"),u={mixins:[c["a"]],components:{AdtTaskContent:o["a"]},data:function(){return{productType:"Y",serviceType:this.$getDictionary("SERVICE_TYPE"),trspType:this.$getDictionary("TRANSPORT_TYPE"),logisticsType:this.$getDictionary("LOGISTICS_TYPE"),contaSizeType:this.$getDictionary("CONTAINER_SIZE_TYPE"),currencyCode:this.$getDictionary("CURRENCY_CODE"),timeUnit:this.$getDictionary("TIME_UNIT"),siteData:{dispatchCity:"",dispatchSite:""},ruleValidate:{dispatchCity:[l["a"].select("国家城市")[0]],dispatchSite:[l["a"].select("场所")[0]]},parameterData:{trspType:"",logisticsType:""},parameterRuleValidate:{trspType:[l["a"].select("运输类型")[0]],logisticsType:[l["a"].select("物流类型")[0]]},dispatchOptions:[],delUrl:function(){}}},methods:{saveProduct:function(e){var t=this,s=JSON.parse(JSON.stringify(e));if(s.sceneNames.length)if(s.serverStartTime=+new Date(s.serverStartTime)||"",s.serverEndTime=+new Date(s.serverEndTime)||"",s.serverStartTime&&s.serverEndTime)if(s.serverStartTime>s.serverEndTime)this.$Message.warning("起始时间不能大于截止时间！");else if(s.serverRemindDuration){var a,i=Object(r["a"])(s.scenesList);try{for(i.s();!(a=i.n()).done;){var n=a.value;if(void 0===n.taskBasesList.taskCost||""===n.taskBasesList.taskCost)return void this.$Message.warning("请输入".concat(n.sceneName,"下的基础服务总费用！"));if(!n.taskBasesList.curr)return void this.$Message.warning("请输入".concat(n.sceneName,"下的基础服务总费用单位！"));if(void 0===n.taskBasesList.serverDuration||""===n.taskBasesList.serverDuration)return void this.$Message.warning("请输入".concat(n.sceneName,"下的基础服务总时长！"));if(!n.taskBasesList.serverDurationUnit)return void this.$Message.warning("请输入".concat(n.sceneName,"下的基础服务总时长单位！"));var c,o=Object(r["a"])(n.taskBasesList.lists);try{for(o.s();!(c=o.n()).done;){var l=c.value;l.taskCost=n.taskBasesList.taskCost,l.curr=n.taskBasesList.curr,l.serverDuration=n.taskBasesList.serverDuration,l.serverDurationUnit=n.taskBasesList.serverDurationUnit}}catch(p){o.e(p)}finally{o.f()}n.taskBasesList=n.taskBasesList.lists;for(var u=0;u<n.taskAffixesList.length;u++)if(n.taskAffixesList[u].isChecked){if(void 0===n.taskAffixesList[u].taskCost||""===n.taskAffixesList[u].taskCost)return void this.$Message.warning("请输入".concat(n.sceneName,"选中的附加任务的费用！"));if(!n.taskAffixesList[u].curr)return void this.$Message.warning("请输入".concat(n.sceneName,"选中的附加任务的费用单位！"));if(void 0===n.taskAffixesList[u].serverDuration||""===n.taskAffixesList[u].serverDuration)return void this.$Message.warning("请输入".concat(n.sceneName,"选中的附加任务的时长！"));if(!n.taskAffixesList[u].serverDurationUnit)return void this.$Message.warning("请输入".concat(n.sceneName,"选中的附加任务的时长单位！"));delete n.taskAffixesList[u].isChecked}else n.taskAffixesList.splice(u,1),u--}}catch(p){i.e(p)}finally{i.f()}delete s.parameters,delete s.sceneNames,delete s.sceneTabIndex,delete s.sites,Object(d["d"])({data:s}).then((function(e){t.$Message.success(e.message),t.hasPendingProduct=!1}))}else this.$Message.warning("请输入产品报价截止时间");else this.$Message.warning("请输入产品起止日期！");else this.$Message.warning("请先选择场景！")},changeDispatchCity:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return t.siteData.dispatchCity=e.data.length?"".concat(e.value.join(";"),"~").concat(e.data[e.data.length-1].addressName):"",s.next=3,t._handelDir(e.value);case 3:t.dispatchOptions=s.sent;case 4:case"end":return s.stop()}}),s)})))()}}},p=u,v=(s("9eb7"),s("2877")),m=Object(v["a"])(p,a,i,!1,null,"7bd798f9",null);t["default"]=m.exports},"9eb7":function(e,t,s){"use strict";var a=s("53be"),i=s.n(a);i.a}}]);