(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1daef5a"],{"25b9":function(t,e,a){"use strict";a.d(e,"h",(function(){return s})),a.d(e,"a",(function(){return o})),a.d(e,"e",(function(){return r})),a.d(e,"b",(function(){return c})),a.d(e,"g",(function(){return l})),a.d(e,"f",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"c",(function(){return f})),a.d(e,"i",(function(){return m})),a.d(e,"j",(function(){return h}));var n=a("2934"),i=a("4ec3"),s=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/query-page"),t)},o=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/add"),t)},r=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/enable"),t)},c=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/disable"),t)},l=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/enable-exam-pass"),t)},u=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/enable-exam-fail"),t)},d=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/disable-exam-pass"),t)},f=function(t){return Object(n["b"])("".concat(i["e"],"/task-base/disable-exam-fail"),t)},m=function(t){return Object(n["a"])("".concat(i["e"],"/task-base/query-detail"),t)},h=function(t){return Object(n["a"])("".concat(i["e"],"/task-base/query-enable-data"),t)}},"7b46":function(t,e,a){"use strict";e["a"]={props:{page:{default:1}},data:function(){return{total:0,perpage:15}},created:function(){this.dataInit("judgment")},watch:{$route:function(){this.dataInit()}},methods:{paginatorInit:function(t,e){this.perpage=t,this.total=e}}}},"91a0":function(t,e,a){},c21d:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"basic-task"},[a("adt-search-folder",{attrs:{searchRouter:{query:{taskCode:t.search.taskCode,taskName:t.search.taskName,trspType:t.search.trspType,examineStatus:t.search.examineStatus,useStatus:t.search.useStatus}},isStatus:!0}},[a("template",{slot:"status"},[a("div",{staticClass:"status"},[a("Col",{attrs:{span:"10"}},[a("div",{staticClass:"name"},[t._v("审核状态:")]),t._l(t.auditStatus,(function(e){return a("span",{key:e.dictionaryKey,class:{"click-status":t.search.examineStatus===e.dictionaryKey},on:{click:function(a){return t.chooseExamineStatus(e.dictionaryKey)}}},[t._v(" "+t._s(e.dictionaryValue)+" ")])}))],2),a("Col",{attrs:{span:"14"}},[a("div",{staticClass:"name"},[t._v("启用状态:")]),t._l(t.enableStatus,(function(e){return a("span",{key:e.dictionaryKey,class:{"click-status":t.search.useStatus===e.dictionaryKey},on:{click:function(a){return t.chooseUseStatus(e.dictionaryKey)}}},[t._v(" "+t._s(e.dictionaryValue)+" ")])}))],2)],1)]),a("template",{slot:"always-show"},[a("Col",{staticClass:"form-item",attrs:{span:"6"}},[a("span",[t._v("基础任务编号:")]),a("Input",{attrs:{clearable:""},model:{value:t.search.taskCode,callback:function(e){t.$set(t.search,"taskCode",e)},expression:"search.taskCode"}})],1),a("Col",{staticClass:"form-item",attrs:{span:"6"}},[a("span",[t._v("基础任务名称:")]),a("Input",{attrs:{clearable:""},model:{value:t.search.taskName,callback:function(e){t.$set(t.search,"taskName",e)},expression:"search.taskName"}})],1),a("Col",{staticClass:"form-item",attrs:{span:"6"}},[a("span",{staticStyle:{"text-align":"right","margin-right":"10px"}},[t._v("运输类型:")]),a("Select",{attrs:{clearable:""},model:{value:t.search.trspType,callback:function(e){t.$set(t.search,"trspType",e)},expression:"search.trspType"}},t._l(t.transportType,(function(e){return a("Option",{key:e.dictionaryKey,attrs:{value:e.dictionaryKey}},[t._v(t._s(e.dictionaryValue))])})),1)],1)],1)],2),a("div",{staticClass:"content"},[a("div",{staticClass:"btns-paginator"},[a("adt-button",[a("Button",{on:{click:function(e){return t.add()}}},[t._v("新增基础任务"),a("Icon",{attrs:{type:"ios-add-circle-outline"}})],1),a("Button",{on:{click:function(e){return t.startUsing()}}},[t._v(t._s("批量启用"+(t.isManager?"":"申请"))),a("Icon",{attrs:{type:"ios-add-circle-outline"}})],1),a("Button",{on:{click:function(e){return t.stopUsing()}}},[t._v(" "+t._s("批量停用"+(t.isManager?"":"申请"))+" "),a("svg",{staticClass:"iconfont",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-tingyong"}})])])],1),a("adt-paginator",{attrs:{currentPage:~~t.page,total:~~t.total}})],1),a("div",{staticClass:"public-table-data"},[a("Table",{attrs:{columns:t.columns,data:t.tableData,stripe:""},on:{"on-selection-change":t.selectionChange},scopedSlots:t._u([{key:"action",fn:function(e){var n=e.row;return[n.useStatus&&"已停用"!==n.useStatus.trim()||"待审核"===n.examineStatus?t._e():a("span",{staticClass:"icon-action icon-action-word",on:{click:function(e){return t.startUsing(n)}}},[t._v("启")]),n.useStatus&&"已启用"===n.useStatus.trim()&&"待审核"!==n.examineStatus?a("span",{staticClass:"icon-action icon-action-word",on:{click:function(e){return t.stopUsing(n)}}},[t._v("停")]):t._e(),t.isManager&&"待审核"===n.examineStatus?a("Icon",{staticClass:"icon-action",attrs:{type:"ios-contact-outline"},on:{click:function(e){return t.examine(n)}}}):t._e(),a("Icon",{staticClass:"icon-action",attrs:{type:"ios-alert-outline"},on:{click:function(e){return t.detail(n)}}})]}},{key:"createDatetime",fn:function(e){var a=e.row;return[t._v(" "+t._s(t.timestampFormat(a.createDatetime))+" ")]}}])})],1)]),a("adt-my-modal",{attrs:{title:t.modalTitle,okText:"保存",showModal:t.isModalShow,width:"70%"},on:{"on-visible-change":t.addVisibleChange,"on-ok":function(e){return t.save()},"on-cancel":function(e){return t.cancel()}}},[a("Form",{ref:"formItemData",staticClass:"two-column",attrs:{inline:"",model:t.formItem,rules:t.formItemRule,"label-width":120,"label-colon":""}},[a("FormItem",{attrs:{label:"基础任务名称",prop:"taskName"}},[a("Input",{attrs:{maxlength:"10",clearable:""},model:{value:t.formItem.taskName,callback:function(e){t.$set(t.formItem,"taskName",e)},expression:"formItem.taskName"}})],1),a("FormItem",{attrs:{label:"物流类型",prop:"logisticsType"}},[a("Select",{attrs:{clearable:""},model:{value:t.formItem.logisticsType,callback:function(e){t.$set(t.formItem,"logisticsType",e)},expression:"formItem.logisticsType"}},t._l(t.logisticsType,(function(e){return a("Option",{key:e.dictionaryKey,attrs:{value:e.dictionaryKey}},[t._v(t._s(e.dictionaryValue))])})),1)],1),a("FormItem",{attrs:{label:"运输类型",prop:"trspType"}},[a("Select",{attrs:{clearable:""},model:{value:t.formItem.trspType,callback:function(e){t.$set(t.formItem,"trspType",e)},expression:"formItem.trspType"}},t._l(t.transportType,(function(e){return a("Option",{key:e.dictionaryKey,attrs:{value:e.dictionaryKey}},[t._v(t._s(e.dictionaryValue))])})),1)],1)],1),a("div",{staticClass:"line"}),a("div",{staticClass:"item-title"},[a("span",[t._v("选择数据项")]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.previewSort()}}},[t._v("排序预览")])],1),a("Table",{attrs:{columns:t.itemColumns,data:t.itemTableData,stripe:""},on:{"on-selection-change":t.itemSelectionChange},scopedSlots:t._u([{key:"sort",fn:function(e){var n=e.row,i=e.index;return[a("div",{staticStyle:{position:"relative"}},[a("span",{staticClass:"required-tag"},[t._v("*")]),a("Input",{attrs:{clearable:""},on:{"on-change":function(e){return t.changeRowData(n,i,"sort")}},model:{value:n.sort,callback:function(e){t.$set(n,"sort","string"===typeof e?e.trim():e)},expression:"row.sort"}})],1)]}},{key:"relationData",fn:function(e){var n=e.row,i=e.index;return[a("Select",{attrs:{clearable:""},on:{"on-change":function(e){return t.changeRowData(n,i,"relationData")}},model:{value:n.relationData,callback:function(e){t.$set(n,"relationData",e)},expression:"row.relationData"}},t._l(t.selectedData,(function(e){return a("Option",{key:e.dataCode,attrs:{value:e.dataCode,disabled:n.dataCode===e.dataCode}},[t._v(t._s(e.dataName))])})),1)]}},{key:"isMore",fn:function(e){var n=e.row,i=e.index;return[a("Select",{attrs:{clearable:""},on:{"on-change":function(e){return t.changeRowData(n,i,"isMore")}},model:{value:n.isMore,callback:function(e){t.$set(n,"isMore",e)},expression:"row.isMore"}},t._l(t.yesOrNo,(function(e){return a("Option",{key:e.dictionaryKey,attrs:{value:e.dictionaryKey}},[t._v(t._s(e.dictionaryValue))])})),1)]}},{key:"isEdit",fn:function(e){var n=e.row,i=e.index;return[a("Select",{attrs:{clearable:""},on:{"on-change":function(e){return t.changeRowData(n,i,"isEdit")}},model:{value:n.isEdit,callback:function(e){t.$set(n,"isEdit",e)},expression:"row.isEdit"}},t._l(t.yesOrNo,(function(e){return a("Option",{key:e.dictionaryKey,attrs:{value:e.dictionaryKey}},[t._v(t._s(e.dictionaryValue))])})),1)]}},{key:"isShow",fn:function(e){var n=e.row,i=e.index;return[a("Select",{attrs:{clearable:""},on:{"on-change":function(e){return t.changeRowData(n,i,"isShow")}},model:{value:n.isShow,callback:function(e){t.$set(n,"isShow",e)},expression:"row.isShow"}},t._l(t.yesOrNo,(function(e){return a("Option",{key:e.dictionaryKey,attrs:{value:e.dictionaryKey}},[t._v(t._s(e.dictionaryValue))])})),1)]}},{key:"rules",fn:function(e){var n=e.row,i=e.index;return[a("Select",{attrs:{multiple:"",clearable:""},on:{"on-change":function(e){return t.changeRowData(n,i,"rules")}},model:{value:n.rules,callback:function(e){t.$set(n,"rules",e)},expression:"row.rules"}},t._l(t.verificationRule,(function(e){return a("Option",{key:e.dictionaryKey,attrs:{value:e.dictionaryKey}},[t._v(t._s(e.dictionaryValue))])})),1)]}},{key:"action",fn:function(e){var n=e.row,i=e.index;return[a("Button",{attrs:{size:"small",type:"primary",ghost:""},on:{click:function(e){return t.enterInfo(n,i)}}},[t._v("录入提示信息")])]}}])})],1),a("adt-my-modal",{attrs:{title:"录入提示信息",showModal:t.isEnterInfoModalShow},on:{"on-visible-change":t.enterInfoVisibleChange,"on-ok":function(e){return t.enterInfoSave()}}},[a("div",{staticClass:"content",staticStyle:{margin:"0 20px"}},[a("div",{staticStyle:{"margin-bottom":"6px"}},[t._v("填写提示信息：")]),a("Input",{attrs:{type:"textarea",placeholder:"请输入内容",autosize:{minRows:6}},model:{value:t.prompt,callback:function(e){t.prompt=e},expression:"prompt"}})],1)]),a("adt-my-modal",{attrs:{title:"预览数据项排序",showModal:t.isPreviewModalShow,showCancelBtn:!1},on:{"on-visible-change":t.previewVisibleChange,"on-ok":function(e){return t.previewSave()}}},[a("Table",{attrs:{columns:t.previewColumns,data:t.previewTableData,stripe:""}})],1),a("adt-my-modal",{attrs:{title:t.examineModalTitle,showModal:t.isExamineModalShow,width:"600"},on:{"on-visible-change":t.examineVisibleChange,"on-ok":function(e){return t.examineSave()}}},[a("RadioGroup",{staticStyle:{"margin-bottom":"20px"},model:{value:t.agree,callback:function(e){t.agree=e},expression:"agree"}},[a("Radio",{attrs:{label:"1"}},[t._v("同意"+t._s(1===t.examineType?"启用":"停用"))]),a("Radio",{staticStyle:{"margin-left":"30px"},attrs:{label:"0"}},[t._v("不同意"+t._s(1===t.examineType?"启用":"停用"))])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"0"===t.agree,expression:"agree === '0'"}]},[a("div",{staticClass:"reason-name",staticStyle:{"margin-bottom":"6px"}},[t._v("填写驳回原因:")]),a("Input",{attrs:{type:"textarea",placeholder:"请输入内容..."},model:{value:t.reason,callback:function(e){t.reason="string"===typeof e?e.trim():e},expression:"reason"}})],1)],1),a("adt-reconfirm-modal",{attrs:{showModal:t.isActionDel,message:t.reconfirmMsg},on:{"on-visible-change":t.visibleChange,"on-ok":function(e){return t.allDelClick()}}})],1)},i=[],s=(a("fe59"),a("053b"),a("513c"),a("1b2e"),a("e18c"),a("e35a"),a("1c2e"),a("9cf3"),a("08ba"),a("e24e")),o=a("80a0"),r=a("25b9"),c=(a("e56e"),a("7b46")),l=a("b962"),u=a("90fe"),d={name:"BasicTask",mixins:[c["a"]],props:{taskCode:"",taskName:"",trspType:"",examineStatus:"",useStatus:""},data:function(){return{enableStatus:this.$getDictionary("ENABLE_STATUS"),auditStatus:this.$getDictionary("AUDIT_STATUS"),transportType:this.$getDictionary("TRANSPORT_TYPE"),logisticsType:this.$getDictionary("LOGISTICS_TYPE"),verificationRule:this.$getDictionary("VERIFICATION_RULE"),yesOrNo:this.$getDictionary("Y_N"),search:{taskCode:this.taskCode,taskName:this.taskName,trspType:this.trspType,examineStatus:this.examineStatus,useStatus:this.useStatus},isManager:this.$route.query.isManager,examineType:1,modalTitle:"新增基础任务",examineModalTitle:"启用审核",isModalShow:!1,isExamineModalShow:!1,isEnterInfoModalShow:!1,isPreviewModalShow:!1,isActionDel:!1,reconfirmMsg:"确定删除吗",examineInfo:{},formItem:{taskName:"",logisticsType:"",trspType:""},tableData:[],columns:[{title:"选择",align:"center",type:"selection",width:60},{title:"基础任务编号",align:"center",key:"taskCode"},{title:"基础任务名称",align:"center",key:"taskName"},{title:"物流类型",align:"center",key:"logisticsType"},{title:"运输类型",align:"center",key:"trspType"},{title:"创建人",align:"center",key:"createBy"},{title:"创建时间",align:"center",slot:"createDatetime"},{title:"审核状态",align:"center",key:"examineStatus"},{title:"启用状态",align:"center",key:"useStatus"},{title:"操作",align:"center",slot:"action",width:170}],formItemRule:{taskName:[l["a"].required("基础任务名称")[0]],logisticsType:[l["a"].select("物流类型")[0]],trspType:[l["a"].select("运输类型")[0]]},itemTableData:[],itemColumns:[{title:"选择",align:"center",type:"selection",width:60},{title:"数据项编码",align:"center",key:"dataCode"},{title:"数据项名称",align:"center",key:"dataName"},{title:"排序值",align:"center",slot:"sort"},{title:"关联数据项",align:"center",slot:"relationData"},{title:"是否多条数据",align:"center",slot:"isMore"},{title:"是否可编辑",align:"center",slot:"isEdit"},{title:"是否展示",align:"center",slot:"isShow"},{title:"校验规则",align:"center",slot:"rules"},{title:"操作",align:"center",slot:"action",width:120}],previewTableData:[],previewColumns:[{title:"序号",align:"center",type:"index"},{title:"数据项名称",align:"center",key:"dataName"},{title:"排序值",align:"center",key:"sort",sortType:"asc"}],agree:"1",reason:"",isAdd:!0,deleteItemInfo:{},selectionList:[],selectedData:[],dictionary:{},enterInfoRow:"",enterInfoIndex:"",prompt:""}},methods:{timestampFormat:function(t){return Object(u["e"])(t)},chooseExamineStatus:function(t){this.search.examineStatus===t?this.search.examineStatus="":this.search.examineStatus=t},chooseUseStatus:function(t){this.search.useStatus===t?this.search.useStatus="":this.search.useStatus=t},selectionChange:function(t){this.selectionList=t},itemSelectionChange:function(t){this.selectedData=t},addVisibleChange:function(t){this.isModalShow=t},examineVisibleChange:function(t){this.isExamineModalShow=t},enterInfoVisibleChange:function(t){this.isEnterInfoModalShow=t},previewVisibleChange:function(t){this.isPreviewModalShow=t},visibleChange:function(t){this.isActionDel=t},dataInit:function(){this.getData()},getData:function(){var t=this,e=Object(o["a"])({page:this.page},this.search);Object(r["h"])({data:e}).then((function(e){t.tableData=e.data.content||[],t.tableData.forEach((function(t){"text"===t.controlType?t.controlType="文本框":t.controlType="下拉框","string"===t.dataType?t.dataType="字符串":t.dataType="数字"})),t.total=e.data.totalElements}))},add:function(){this.getItemData(),this.isModalShow=!0,this.modalTitle="新增基础任务",this.isAdd=!0},getItemData:function(){var t=this;Object(r["j"])().then((function(e){var a=e.data;t.itemTableData=a}))},startUsing:function(t){var e=this,a=this.handleRequestData(t);a.length&&Object(r["e"])({data:a}).then((function(t){e.$Message.info(t.message),e.getData()}))},stopUsing:function(t){var e=this,a=this.handleRequestData(t);a.length&&Object(r["b"])({data:a}).then((function(t){e.$Message.info(t.message),e.getData()}))},handleRequestData:function(t){var e=[];if(t)return e.push(o(t)),e;if(this.selectionList.length){var a,n=Object(s["a"])(this.selectionList);try{for(n.s();!(a=n.n()).done;){var i=a.value;e.push(o(i))}}catch(r){n.e(r)}finally{n.f()}}else this.$Message.warning("请先选择基础任务");return e;function o(t){var e=t.taskCode,a=t.useStatus,n=t.version,i=t.examineStatus;return{taskCode:e,useStatus:a,version:n,examineStatus:i}}},edit:function(t){var e=this;this.isAdd=!1;var a={name:t.name};getBasicTaskQuery(a).then((function(t){e.formItem=t.data,e.formItem.maxLength=e.formItem.maxLength.toString(),e.formItem.rules=t.data.rules||[],e.isModalShow=!0,e.modalTitle="编辑基础任务"}))},remove:function(t){this.isActionDel=!0,this.deleteItemInfo={name:t.name}},detail:function(t){this.$router.push("/standard-mapper/basics-task/detail/".concat(t.taskCode))},allDelClick:function(){var t=this;apiBasicTaskDel(this.deleteItemInfo).then((function(e){200==e.code?(t.$Message.info("删除成功"),t.isActionDel=!1,t.getData()):t.$Message.info("删除失败")}))},changeRowData:function(t,e,a){this.itemTableData[e]=t;var n,i=Object(s["a"])(this.selectedData);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.dataCode===t.dataCode){o[a]="sort"===a?Number(t[a]):t[a];break}}}catch(r){i.e(r)}finally{i.f()}},save:function(){var t=this,e=this;function a(){e.$Message.info("保存成功"),e.$refs.formItemData.resetFields(),e.selectedData=[],e.isModalShow=!1,e.getData()}this.$refs.formItemData.validate((function(e){if(e){if(!t.verifyItem())return;var n=Object(o["a"])({},t.formItem);n.datas=t.selectedData,t.isAdd?Object(r["a"])({data:n}).then((function(t){a()})):apiBasicTaskUpdate({data:n}).then((function(t){a()}))}}))},cancel:function(){this.$refs.formItemData.resetFields(),this.selectedData=[]},examine:function(t){"enable"!==t.useStatus?(this.examineType=1,this.examineModalTitle="启用审核"):(this.examineType=0,this.examineModalTitle="停用审核"),this.examineInfo.taskCode=t.taskCode,this.examineInfo.version=t.version,this.isExamineModalShow=!0},examineSave:function(){var t=this,e=Object(o["a"])({},this.examineInfo);if(1===this.examineType)if("1"===this.agree)Object(r["g"])({data:e}).then((function(e){t.$Message.info(e.message),t.isExamineModalShow=!1,t.getData()}));else{if(!this.reason)return void this.$Message.warning("请填写驳回原因！");e.message=this.reason,Object(r["f"])({data:e}).then((function(e){t.$Message.info(e.message),t.isExamineModalShow=!1,t.getData()}))}else if("1"===this.agree)Object(r["d"])({data:e}).then((function(e){t.$Message.info(e.message),t.isExamineModalShow=!1,t.getData()}));else{if(!this.reason)return void this.$Message.warning("请填写输入驳回原因！");e.message=this.reason,Object(r["c"])({data:e}).then((function(e){t.$Message.info(e.message),t.isExamineModalShow=!1,t.getData()}))}},enterInfo:function(t,e){this.enterInfoRow=t,this.enterInfoIndex=e,this.prompt=t.message,this.isEnterInfoModalShow=!0},enterInfoSave:function(){this.$set(this.itemTableData[this.enterInfoIndex],"message",this.prompt);var t,e=Object(s["a"])(this.selectedData);try{for(e.s();!(t=e.n()).done;){var a=t.value;if(a.dataCode===this.enterInfoRow.dataCode){a.message=this.enterInfoRow.message;break}}}catch(n){e.e(n)}finally{e.f()}this.isEnterInfoModalShow=!1},previewSave:function(){this.isPreviewModalShow=!1},previewSort:function(){this.verifyItem()&&(this.previewTableData=this.selectedData,this.isPreviewModalShow=!0)},verifyItem:function(){var t,e=[],a=Object(s["a"])(this.selectedData);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(!n.sort&&!Number.isNaN(n.sort))return this.$Message.warning("选中的数据项的排序值必填！"),!1;if(!/^\d+$/.test(n.sort))return void this.$Message.warning("排序值只能是整数！");if(n.dataCode===n.relationData)return this.$Message.warning("选中的数据项的关联数据项不是是它本身！"),!1;e.push(n.sort)}}catch(i){a.e(i)}finally{a.f()}return!Object(u["c"])(e)||(this.$Message.warning("选中的数据项的排序值不能重复！"),!1)}}},f=d,m=(a("fcf1"),a("4023")),h=Object(m["a"])(f,n,i,!1,null,"67a94ffa",null);e["default"]=h.exports},fcf1:function(t,e,a){"use strict";var n=a("91a0"),i=a.n(n);i.a}}]);
//# sourceMappingURL=chunk-c1daef5a.b4f09142.js.map