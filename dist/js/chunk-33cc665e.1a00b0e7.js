(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33cc665e"],{"00b8":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"item-manage"},[a("adt-search-folder",{attrs:{searchRouter:{query:{label:e.search.label,examineStatus:e.search.examineStatus,useStatus:e.search.useStatus}},isStatus:!0}},[a("template",{slot:"status"},[a("div",{staticClass:"status"},[a("Col",{attrs:{span:"10"}},[a("div",{staticClass:"name"},[e._v("审核状态:")]),e._l(e.auditStatus,(function(t){return a("span",{key:t.dictionaryKey,class:{"click-status":e.search.examineStatus===t.dictionaryKey},on:{click:function(a){return e.chooseExamineStatus(t.dictionaryKey)}}},[e._v(" "+e._s(t.dictionaryValue)+" ")])}))],2),a("Col",{attrs:{span:"14"}},[a("div",{staticClass:"name"},[e._v("启用状态:")]),e._l(e.enableStatus,(function(t){return a("span",{key:t.dictionaryKey,class:{"click-status":e.search.useStatus===t.dictionaryKey},on:{click:function(a){return e.chooseUseStatus(t.dictionaryKey)}}},[e._v(" "+e._s(t.dictionaryValue)+" ")])}))],2)],1)]),a("template",{slot:"always-show"},[a("Col",{staticClass:"form-item",attrs:{span:"8"}},[a("span",[e._v("数据项名称:")]),a("Input",{attrs:{clearable:""},model:{value:e.search.label,callback:function(t){e.$set(e.search,"label",t)},expression:"search.label"}})],1)],1)],2),a("div",{staticClass:"content"},[a("div",{staticClass:"btns-paginator"},[a("adt-button",[a("Button",{on:{click:function(t){return e.add()}}},[e._v("新增数据项"),a("Icon",{attrs:{type:"ios-add-circle-outline"}})],1),a("Button",{on:{click:function(t){return e.startUsing()}}},[e._v(e._s("批量启用"+(e.isManager?"":"申请"))),a("Icon",{attrs:{type:"ios-add-circle-outline"}})],1),a("Button",{on:{click:function(t){return e.stopUsing()}}},[e._v(" "+e._s("批量停用"+(e.isManager?"":"申请"))+" "),a("svg",{staticClass:"iconfont",attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":"#icon-tingyong"}})])])],1),a("adt-paginator",{attrs:{currentPage:~~e.page,total:~~e.total}})],1),a("div",{staticClass:"public-table-data"},[a("Table",{attrs:{columns:e.columns,data:e.tableData,stripe:""},on:{"on-selection-change":e.selectionChange},scopedSlots:e._u([{key:"createDatetime",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.timestampFormat(a.createDatetime))+" ")]}},{key:"action",fn:function(t){var n=t.row;return[n.useStatus&&"已停用"!==n.useStatus.trim()||"待审核"===n.examineStatus?e._e():a("span",{staticClass:"icon-action icon-action-word",on:{click:function(t){return e.startUsing(n)}}},[e._v("启")]),n.useStatus&&"已启用"===n.useStatus.trim()&&"待审核"!==n.examineStatus?a("span",{staticClass:"icon-action icon-action-word",on:{click:function(t){return e.stopUsing(n)}}},[e._v("停")]):e._e(),e.isManager&&"待审核"===n.examineStatus?a("Icon",{staticClass:"icon-action",attrs:{type:"ios-contact-outline"},on:{click:function(t){return e.examine(n)}}}):e._e(),a("Icon",{staticClass:"icon-action",attrs:{type:"ios-alert-outline"},on:{click:function(t){return e.detail(n)}}})]}}])})],1)]),a("adt-my-modal",{attrs:{title:e.modalTitle,okText:"保存",showModal:e.isModalShow,width:"650"},on:{"on-visible-change":e.addVisibleChange,"on-ok":function(t){return e.save()},"on-cancel":function(t){return e.cancel()}}},[a("Form",{ref:"formItemData",staticClass:"two-column",attrs:{inline:"",model:e.formItem,rules:e.formItemRule,"label-width":120,"label-position":"left","label-colon":""}},[a("FormItem",{attrs:{label:"数据项编号",prop:"name"}},[a("Input",{attrs:{disabled:!e.isAdd,clearable:""},model:{value:e.formItem.name,callback:function(t){e.$set(e.formItem,"name",t)},expression:"formItem.name"}})],1),a("FormItem",{attrs:{label:"数据项名称",prop:"label"}},[a("Input",{attrs:{clearable:""},model:{value:e.formItem.label,callback:function(t){e.$set(e.formItem,"label",t)},expression:"formItem.label"}})],1),a("FormItem",{attrs:{label:"数据项分类",prop:"itemType"}},[a("Select",{attrs:{clearable:""},model:{value:e.formItem.itemType,callback:function(t){e.$set(e.formItem,"itemType",t)},expression:"formItem.itemType"}},e._l(e.itemType,(function(t){return a("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(e._s(t.dictionaryValue))])})),1)],1),a("FormItem",{attrs:{label:"控件类型",prop:"controlType"}},[a("Select",{attrs:{clearable:""},model:{value:e.formItem.controlType,callback:function(t){e.$set(e.formItem,"controlType",t)},expression:"formItem.controlType"}},e._l(e.controlType,(function(t){return a("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(e._s(t.dictionaryValue))])})),1)],1),a("FormItem",{attrs:{label:"数据类型",prop:"dataType"}},[a("Select",{attrs:{clearable:""},model:{value:e.formItem.dataType,callback:function(t){e.$set(e.formItem,"dataType",t)},expression:"formItem.dataType"}},e._l(e.dataType,(function(t){return a("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(e._s(t.dictionaryValue))])})),1)],1),a("FormItem",{attrs:{label:"数据最大长度",prop:"maxLength"}},[a("Input",{attrs:{clearable:""},model:{value:e.formItem.maxLength,callback:function(t){e.$set(e.formItem,"maxLength",t)},expression:"formItem.maxLength"}})],1),a("FormItem",{class:"string"!==e.formItem.dataType&&e.formItem.dataType?"ivu-form-item-required":"",attrs:{label:"数据精度",prop:"accuracy","show-message":!("string"===e.formItem.dataType||!e.formItem.dataType)}},[a("Input",{attrs:{clearable:""},model:{value:e.formItem.accuracy,callback:function(t){e.$set(e.formItem,"accuracy",t)},expression:"formItem.accuracy"}})],1),a("FormItem",{class:"I"!==e.formItem.controlType&&e.formItem.controlType?"ivu-form-item-required":"",attrs:{label:"数据来源",prop:"source","show-message":!("I"===e.formItem.controlType||!e.formItem.controlType)}},[a("Select",{attrs:{clearable:""},model:{value:e.formItem.source,callback:function(t){e.$set(e.formItem,"source",t)},expression:"formItem.source"}},e._l(e.dataSource,(function(t){return a("Option",{key:t.dictionaryKey,attrs:{value:t.dictionaryKey}},[e._v(e._s(t.dictionaryValue))])})),1)],1),a("FormItem",{class:"I"!==e.formItem.controlType&&e.formItem.controlType?"ivu-form-item-required":"",attrs:{label:"数据来源值",prop:"sourceValue","show-message":!("I"===e.formItem.controlType||!e.formItem.controlType)}},[a("Input",{attrs:{clearable:""},model:{value:e.formItem.sourceValue,callback:function(t){e.$set(e.formItem,"sourceValue",t)},expression:"formItem.sourceValue"}})],1),a("FormItem",{attrs:{label:"备注规则",prop:"note"}},[a("Input",{staticStyle:{width:"470px"},attrs:{type:"textarea"},model:{value:e.formItem.note,callback:function(t){e.$set(e.formItem,"note",t)},expression:"formItem.note"}})],1)],1)],1),a("adt-my-modal",{attrs:{title:e.examineModalTitle,showModal:e.isExamineModalShow,width:"600"},on:{"on-visible-change":e.examineVisibleChange,"on-ok":function(t){return e.examineSave()}}},[a("RadioGroup",{staticStyle:{"margin-bottom":"20px"},model:{value:e.agree,callback:function(t){e.agree=t},expression:"agree"}},[a("Radio",{attrs:{label:"1"}},[e._v("同意"+e._s(1===e.examineType?"启用":"停用"))]),a("Radio",{staticStyle:{"margin-left":"30px"},attrs:{label:"0"}},[e._v("不同意"+e._s(1===e.examineType?"启用":"停用"))])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"0"===e.agree,expression:"agree === '0'"}]},[a("div",{staticClass:"reason-name",staticStyle:{"margin-bottom":"6px"}},[e._v("填写驳回原因:")]),a("Input",{attrs:{type:"textarea",placeholder:"请输入内容..."},model:{value:e.reason,callback:function(t){e.reason="string"===typeof t?t.trim():t},expression:"reason"}})],1)],1),a("adt-reconfirm-modal",{attrs:{showModal:e.isActionDel,message:e.reconfirmMsg},on:{"on-visible-change":e.visibleChange,"on-ok":function(t){return e.allDelClick()}}})],1)},i=[],s=(a("053b"),a("e18c"),a("e35a"),a("1c2e"),a("9cf3"),a("6db4"),a("e24e")),o=a("80a0"),r=a("a37b"),c=(a("e56e"),a("7b46")),l=a("b962"),u=a("90fe"),m={name:"ItemManage",mixins:[c["a"]],props:{label:"",examineStatus:"",useStatus:""},data:function(){return{enableStatus:this.$getDictionary("ENABLE_STATUS"),auditStatus:this.$getDictionary("AUDIT_STATUS"),itemType:this.$getDictionary("ITEM_TYPE"),controlType:this.$getDictionary("CONTROL_TYPE"),dataType:this.$getDictionary("DATA_TYPE"),dataSource:this.$getDictionary("DATA_SOURCE"),search:{label:this.label,examineStatus:this.examineStatus,useStatus:this.useStatus},isManager:this.$route.query.isManager,examineType:1,modalTitle:"新增数据项",examineModalTitle:"启用审核",isModalShow:!1,isExamineModalShow:!1,isActionDel:!1,reconfirmMsg:"确定删除吗",examineInfo:{},formItem:{name:"",label:"",itemType:"",controlType:"",dataType:"",maxLength:"",accuracy:"",source:"",sourceValue:"",note:""},tableData:[],columns:[{title:"选择",align:"center",type:"selection",width:60},{title:"数据项编号",align:"center",key:"name"},{title:"数据项名称",align:"center",key:"label"},{title:"控件类型",align:"center",key:"controlType"},{title:"数据来源",align:"center",key:"source"},{title:"数据来源值",align:"center",key:"sourceValue"},{title:"数据类型",align:"center",key:"dataType"},{title:"创建人",align:"center",key:"createBy"},{title:"创建时间",align:"center",slot:"createDatetime"},{title:"审核状态",align:"center",key:"examineStatus"},{title:"启用状态",align:"center",key:"useStatus"},{title:"操作",align:"center",slot:"action",width:150}],formItemRule:{name:[l["a"].required("数据项编号")[0],{pattern:/^[a-z_]*$/,message:"只能输入小写字母和_"}],label:[l["a"].required("数据项名称")[0]],itemType:[l["a"].select("数据项分类")[0]],controlType:[l["a"].select("控件类型")[0]],dataType:[l["a"].select("数据类型")[0]],maxLength:[l["a"].required("数据最大长度")[0],{pattern:/^[0-9]*$/,message:"只能输入数字"}]},agree:"1",reason:"",isAdd:!0,deleteItemInfo:{},selectionList:[]}},methods:{timestampFormat:function(e){return Object(u["e"])(e)},chooseExamineStatus:function(e){this.search.examineStatus===e?this.search.examineStatus="":this.search.examineStatus=e},chooseUseStatus:function(e){this.search.useStatus===e?this.search.useStatus="":this.search.useStatus=e},selectionChange:function(e){this.selectionList=e},addVisibleChange:function(e){this.isModalShow=e},examineVisibleChange:function(e){this.isExamineModalShow=e},visibleChange:function(e){this.isActionDel=e},dataInit:function(){this.getData()},getData:function(){var e=this,t=Object(o["a"])({page:this.page},this.search);Object(r["h"])({data:t}).then((function(t){e.tableData=t.data.content||[],e.total=t.data.totalElements}))},add:function(){this.isModalShow=!0,this.modalTitle="新增数据项",this.isAdd=!0},startUsing:function(e){var t=this,a=this.handleRequestData(e);a.length&&Object(r["e"])({data:a}).then((function(e){t.$Message.info(e.message),t.getData()}))},stopUsing:function(e){var t=this,a=this.handleRequestData(e);a.length&&Object(r["b"])({data:a}).then((function(e){t.$Message.info(e.message),t.getData()}))},handleRequestData:function(e){var t=[];if(e)return t.push(o(e)),t;if(this.selectionList.length){var a,n=Object(s["a"])(this.selectionList);try{for(n.s();!(a=n.n()).done;){var i=a.value;t.push(o(i))}}catch(r){n.e(r)}finally{n.f()}}else this.$Message.warning("请先选择数据项");return t;function o(e){var t=e.name,a=e.useStatus,n=e.version,i=e.examineStatus;return{name:t,useStatus:a,version:n,examineStatus:i}}},edit:function(e){var t=this;this.isAdd=!1;var a={name:e.name};getTemplateDataQuery(a).then((function(e){t.formItem=e.data,t.formItem.maxLength=t.formItem.maxLength.toString(),t.formItem.rules=e.data.rules||[],t.isModalShow=!0,t.modalTitle="编辑数据项"}))},remove:function(e){this.isActionDel=!0,this.deleteItemInfo={name:e.name}},detail:function(e){this.$router.push("/standard-mapper/item-manage/detail/".concat(e.name))},allDelClick:function(){var e=this;apiTemplateDataDel(this.deleteItemInfo).then((function(t){200==t.code?(e.$Message.info("删除成功"),e.isActionDel=!1,e.getData()):e.$Message.info("删除失败")}))},save:function(){var e=this,t=this;function a(){t.$Message.info("保存成功"),t.$refs.formItemData.resetFields(),t.isModalShow=!1,t.getData()}"I"!==this.formItem.controlType?(this.formItemRule.source=l["a"].select("数据来源"),this.formItemRule.sourceValue=l["a"].select("数据来源值")):(this.formItemRule.source=[],this.formItemRule.sourceValue=[]),"string"!==this.formItem.dataType?this.formItemRule.accuracy=l["a"].required("数据精度"):this.formItemRule.accuracy=[],this.$refs.formItemData.validate((function(t){if(t){var n=e.formItem;e.isAdd?Object(r["a"])({data:n}).then((function(t){a(),e.getData()})):apiTemplateDataUpdate({data:n}).then((function(e){a()}))}}))},cancel:function(){this.$refs.formItemData.resetFields()},examine:function(e){e.useStatus&&"已停用"!==e.useStatus.trim()?(this.examineType=0,this.examineModalTitle="停用审核"):(this.examineType=1,this.examineModalTitle="启用审核"),this.examineInfo.name=e.name,this.examineInfo.version=e.version,this.isExamineModalShow=!0},examineSave:function(){var e=this,t=Object(o["a"])({},this.examineInfo);if(1===this.examineType)if("1"===this.agree)Object(r["g"])({data:t}).then((function(t){e.$Message.info(t.message),e.isExamineModalShow=!1,e.getData()}));else{if(!this.reason)return void this.$Message.warning("请填写驳回原因！");t.message=this.reason,Object(r["f"])({data:t}).then((function(t){e.$Message.info(t.message),e.isExamineModalShow=!1,e.getData()}))}else if("1"===this.agree)Object(r["d"])({data:t}).then((function(t){e.$Message.info(t.message),e.isExamineModalShow=!1,e.getData()}));else{if(!this.reason)return void this.$Message.warning("请填写输入驳回原因！");t.message=this.reason,Object(r["c"])({data:t}).then((function(t){e.$Message.info(t.message),e.isExamineModalShow=!1,e.getData()}))}}}},f=m,d=a("4023"),h=Object(d["a"])(f,n,i,!1,null,null,null);t["default"]=h.exports},"6db4":function(e,t,a){"use strict";var n=a("1c8b"),i=a("c10f").trim,s=a("f221");n({target:"String",proto:!0,forced:s("trim")},{trim:function(){return i(this)}})},"7b46":function(e,t,a){"use strict";t["a"]={props:{page:{default:1}},data:function(){return{total:0,perpage:15}},created:function(){this.dataInit("judgment")},watch:{$route:function(){this.dataInit()}},methods:{paginatorInit:function(e,t){this.perpage=e,this.total=t}}}},a37b:function(e,t,a){"use strict";a.d(t,"h",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return c})),a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"i",(function(){return d}));var n=a("2934"),i=a("4ec3"),s=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/query-page"),e)},o=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/add"),e)},r=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/enable"),e)},c=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/disable"),e)},l=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/enable-exam-pass"),e)},u=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/enable-exam-fail"),e)},m=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/disable-exam-pass"),e)},f=function(e){return Object(n["b"])("".concat(i["e"],"/template-data/disable-exam-fail"),e)},d=function(e){return Object(n["a"])("".concat(i["e"],"/template-data/query-detail"),e)}},f221:function(e,t,a){var n=a("efe2"),i=a("fc8c"),s="​᠎";e.exports=function(e){return n((function(){return!!i[e]()||s[e]()!=s||i[e].name!==e}))}}}]);